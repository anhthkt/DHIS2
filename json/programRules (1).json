{"programRules":[{"name":"THA_BienChung_Hide","condition":"#{THA_BienChung} != '2'","programRuleActions":[{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Ghi rõ biến chứng"}}]},{"name":"THA_BMI_Show_Value","condition":"#{CanNang_THA} > 0 && #{ChieuCao_THA} > 0","programRuleActions":[{"programRuleActionType":"DISPLAYKEYVALUEPAIR","content":"BMI_THA"}]},{"name":"THA_Bắt buộc nhập HA, thuốc","condition":"#{PhanLoaiBenhNhanHienTai} == '1' || #{PhanLoaiBenhNhanHienTai} == '2' || #{PhanLoaiBenhNhanHienTai} == '0'","programRuleActions":[{"programRuleActionType":"SETMANDATORYFIELD","dataElement":{"name":"Huyết áp tâm trương"}},{"programRuleActionType":"SETMANDATORYFIELD","dataElement":{"name":"Huyết áp tâm thu"}},{"programRuleActionType":"SETMANDATORYFIELD","dataElement":{"name":"Thuốc huyết áp"}}]},{"name":"THA_CanNang < 0 (Cảnh báo lỗi)","condition":"#{CanNang_THA} < 0","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại trường cân nặng","dataElement":{"name":"Cân nặng"}}]},{"name":"THA_ChieuCao < 0 (Cảnh báo lỗi)","condition":"#{ChieuCao_THA} < 0","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại trường chiều cao","dataElement":{"name":"Chiều cao"}}]},{"name":"THA_ChiQuanLy_Hide","condition":"#{PhanLoaiBenhNhanHienTai} == '5'","programRuleActions":[{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Thuốc huyết áp"}}]},{"name":"THA_Cholesterol (Cảnh báo lỗi) ","condition":"d2:hasValue(#{THA_Cholesterol}) && (#{THA_Cholesterol} < 3 || #{THA_Cholesterol} > 7)","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại trường Cholesterol toàn phần","dataElement":{"name":"Cholesterol toàn phần"}}]},{"name":"THA_HATamThu < 70 (Cảnh báo lỗi)","condition":"d2:hasValue(#{HATamThu}) && #{HATamThu} < 70","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại chỉ số huyết áp tâm thu","dataElement":{"name":"Huyết áp tâm thu"}}]},{"name":"THA_HATamThu > 300 (Cảnh báo lỗi)","condition":"#{HATamThu} > 300","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại chỉ số huyết áp tâm thu","dataElement":{"name":"Huyết áp tâm thu"}}]},{"name":"THA_HATamTruong < 40 (Cảnh báo lỗi)","condition":"d2:hasValue(#{HATamTruong}) && #{HATamTruong} < 40","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại chỉ số huyết áp tâm trương","dataElement":{"name":"Huyết áp tâm trương"}}]},{"name":"THA_HATamTruong > 250 (Cảnh báo lỗi)","condition":"#{HATamTruong} > 250","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại chỉ số huyết áp tâm trương","dataElement":{"name":"Huyết áp tâm trương"}}]},{"name":"THA_HDL (Cảnh báo lỗi) ","condition":"d2:hasValue(#{THA_HDL}) && (#{THA_HDL} < 0 || #{THA_HDL} > 3)","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại trường HDL","dataElement":{"name":"HDL"}}]},{"name":"THA_LDL (Cảnh báo lỗi) ","condition":"d2:hasValue(#{THA_LDL}) && (#{THA_LDL} < 0 || #{THA_LDL} > 5)","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại trường LDL","dataElement":{"name":"LDL"}}]},{"name":"THA_Lỗi nhập 2 lần phân loại BN mới","condition":"#{PhanLoaiBenhNhanTruoc} =='1' &&#{PhanLoaiBenhNhanHienTai} =='1'","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng xem lại phân loại bệnh nhân. Bệnh nhân này đã được đăng ký là bệnh nhân mới từ lần khám trước.","dataElement":{"name":"Phân loại bệnh nhân"}}]},{"name":"THA_Lỗi Năm sinh < Ngày đăng ký ","condition":"d2:daysBetween( A{Attr_DateBirthTHA},V{enrollment_date}) < 0","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại. Năm sinh phải trước Ngày đăng ký"}]},{"name":"THA_Nguy_Co_DTD_BMI_23_27.5_Score","condition":"#{CanNang_THA} > 0 && #{ChieuCao_THA} > 0 && (#{CanNang_THA}) /((d2:zing(#{ChieuCao_THA}) /100)*(d2:zing(#{ChieuCao_THA}) /100)) > 23 && (#{CanNang_THA}) /((d2:zing(#{ChieuCao_THA}) /100)*(d2:zing(#{ChieuCao_THA}) /100)) < 27.5","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_BMI_Score}"}]},{"name":"THA_Nguy_Co_DTD_BMI_23_Score","condition":"(#{CanNang_THA} > 0 && #{ChieuCao_THA} > 0 && (#{CanNang_THA}) /((d2:zing(#{ChieuCao_THA}) /100)*(d2:zing(#{ChieuCao_THA}) /100)) < 23) ||( ! #{CanNang_THA})  || (! #{ChieuCao_THA} )","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_BMI_Score}"}]},{"name":"THA_Nguy_Co_DTD_BMI_27.5_Score","condition":"#{CanNang_THA} > 0 && #{ChieuCao_THA} > 0 && (#{CanNang_THA}) /((d2:zing(#{ChieuCao_THA}) /100)*(d2:zing(#{ChieuCao_THA}) /100)) > 27.5","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_BMI_Score}"}]},{"name":"THA_Nguy_Co_DTD_GioiTinh_Nam_Score","condition":"A{GioiTinh} == 'Nam'","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_GioiTinh_Score}"}]},{"name":"THA_Nguy_Co_DTD_GioiTinh_Nu_Score","condition":"(A{GioiTinh} == 'Nữ') ||( !A{GioiTinh})","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_GioiTinh_Score}"}]},{"name":"THA_Nguy_Co_DTD_HuyetAp_Thu_<140_Truong_<90_Score","condition":"(#{HATamTruong} <90 &&#{HATamThu}<140) ||( !#{HATamTruong}) || ( !#{HATamThu})","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_HuyetAp_Score}"}]},{"name":"THA_Nguy_Co_DTD_HuyetAp_Thu_>140_Truong_>90_Score","condition":"#{HATamTruong} >= 90  || #{HATamThu}>=140","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_HuyetAp_Score}"}]},{"name":"THA_Nguy_co_DTD_Show_Value","condition":"true","programRuleActions":[{"programRuleActionType":"DISPLAYKEYVALUEPAIR","content":"Nguy cơ ĐTĐ"}]},{"name":"THA_Nguy_Co_DTD_TienSu_Co_Score","condition":"d2:hasValue( 'TienSuGiaDinh' )","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_TienSu_Score}"}]},{"name":"THA_Nguy_Co_DTD_TienSu_Khong_Score","condition":"!A{TienSuGiaDinh}","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_TienSu_Score}"}]},{"name":"THA_Nguy_Co_DTD_Tuoi_45_49_Score","condition":"d2:yearsBetween( A{Attr_DateBirthTHA}, V{event_date} ) >= 45 && d2:yearsBetween( A{Attr_DateBirthTHA}, V{event_date} ) <= 49","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_Tuoi_Score}"}]},{"name":"THA_Nguy_Co_DTD_Tuoi_45_Score","condition":"(d2:yearsBetween(A{Attr_DateBirthTHA},V{event_date}) < 45) ||( !A{Attr_DateBirthTHA})","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_Tuoi_Score}"}]},{"name":"THA_Nguy_Co_DTD_Tuoi_49_Score","condition":"d2:yearsBetween( A{Attr_DateBirthTHA}, V{event_date} ) > 49","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_Tuoi_Score}"}]},{"name":"THA_Nguy_Co_DTD_VongEo_Nam_<90_Nu_<80_Score","condition":"(#{Vong eo_THA} >0 &&((A{GioiTinh} =='Nam' &&#{Vong eo_THA} <90) || (A{GioiTinh} =='Nữ' &&#{Vong eo_THA} <80))) ||( !#{Vong eo_THA})","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_VongEo_Score}"}]},{"name":"THA_Nguy_Co_DTD_VongEo_Nam_>90_Nu_>80_Score","condition":"#{Vong eo_THA} >0 &&((A{GioiTinh} =='Nam' &&#{Vong eo_THA} >=90) || (A{GioiTinh} =='Nữ' &&#{Vong eo_THA} >=80))","programRuleActions":[{"programRuleActionType":"ASSIGN","content":"#{NguyCoDTD_VongEo_Score}"}]},{"name":"THA_Nhập chứng minh thư (Bắt buộc)","condition":"A{Ma BHYT_THA} == ''","programRuleActions":[{"programRuleActionType":"SETMANDATORYFIELD"}]},{"name":"THA_Nhập chứng minh thư (Cảnh báo lỗi)","condition":"d2:hasValue('So CMT_THA') && d2:validatePattern( A{So CMT_THA}, '.*[a-zA-Z]+.*' )","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Kiểm tra lại số CMTND/CCCD"}]},{"name":"THA_Nhập mã BHYT (Bắt buộc)","condition":"A{So CMT_THA} == ''","programRuleActions":[{"programRuleActionType":"SETMANDATORYFIELD"}]},{"name":"THA_Nhập số điện thoại (Lỗi nhập có chữ cái)","condition":"d2:hasValue('SoDienThoai_THA') && d2:validatePattern( A{SoDienThoai_THA}, '.*[a-zA-Z]+.*' )","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Kiểm tra lại số điện thoại."}]},{"name":"THA_TRIGLYCERIDE (Cảnh báo lỗi) ","condition":"d2:hasValue(#{THA_Triglyceride}) && (#{THA_Triglyceride} < 0 || #{THA_Triglyceride} > 6)","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại trường Triglyceride","dataElement":{"name":"Triglyceride"}}]},{"name":"THA_TuVong_BoChuyen_Hide","condition":"#{PhanLoaiBenhNhanHienTai} == '3' || #{PhanLoaiBenhNhanHienTai} == '4'","programRuleActions":[{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Cân nặng"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Vòng eo"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Nguy cơ tim mạch"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Chiều cao"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Huyết áp tâm trương"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Hút thuốc lá "}},{"programRuleActionType":"HIDESECTION","dataElement":{"name":"Chẩn đoán"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Có đang thực hành ăn giảm muối không"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Hoạt động thể lực đủ/nhiều hơn mức khuyến nghị không"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Biến chứng"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Huyết áp tâm thu"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Có ăn đủ 5 đơn vị hay 400g rau và trái cây/ngày không"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Thực hành ăn uống hợp lý"}},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Cholesterol toàn phần"}},{"programRuleActionType":"HIDESECTION"},{"programRuleActionType":"HIDEFIELD","dataElement":{"name":"Mức độ uống rượu, bia"}}]},{"name":"THA_Vòng eo < 10 (Cảnh báo lỗi)","condition":"#{Vong eo_THA} < 10   &&#{Vong eo_THA} > 0 ||#{Vong eo_THA} < 0","programRuleActions":[{"programRuleActionType":"SHOWERROR","content":"Vui lòng kiểm tra lại số liệu vòng eo","dataElement":{"name":"Vòng eo"}}]},{"name":"THA_Đạt mục tiêu điều trị chuẩn cũ_Assign value 0","condition":"#{HATamThu}>=140 ||#{HATamTruong} >=90 ||#{HATamThu} ==0 ||#{HATamTruong} == 0","programRuleActions":[{"programRuleActionType":"ASSIGN","dataElement":{"name":"Đạt MTĐT chuẩn cũ"}}]},{"name":"THA_Đạt mục tiêu điều trị chuẩn cũ_Assign value 1","condition":"(#{HATamThu} >0 &&#{HATamThu}<140) &&(#{HATamTruong} >0 &&#{HATamTruong}<90)","programRuleActions":[{"programRuleActionType":"ASSIGN","dataElement":{"name":"Đạt MTĐT chuẩn cũ"}}]},{"name":"THA_Đạt mục tiêu điều trị chuẩn cũ_Show text","condition":"(#{HATamThu} > 0  && #{HATamThu} < 140)  && (#{HATamTruong}  > 0  && #{HATamTruong} < 90)","programRuleActions":[{"programRuleActionType":"DISPLAYTEXT","content":"Đạt mục tiêu điều trị chuẩn cũ"}]},{"name":"THA_Đạt mục tiêu điều trị chuẩn mới_Assign value 0","condition":"(#{HATamThu}>=140 && d2:yearsBetween(A{Attr_DateBirthTHA},V{event_date}) > 65 ) || \n(#{HATamThu}>=130 && d2:yearsBetween(A{Attr_DateBirthTHA},V{event_date}) < 65 )\n||#{HATamThu} ==0 ||#{HATamTruong} == 0 || #{HATamTruong}>=80","programRuleActions":[{"programRuleActionType":"ASSIGN","dataElement":{"name":"Đạt MTĐT chuẩn mới"}}]},{"name":"THA_Đạt mục tiêu điều trị chuẩn mới_Assign value 1","condition":"(#{HATamThu} >1 &&#{HATamThu}<140) &&(#{HATamTruong} >1 &&#{HATamTruong}<80)  && d2:yearsBetween(A{Attr_DateBirthTHA},V{event_date}) > 65    || (#{HATamThu} >1 &&#{HATamThu}<130) &&(#{HATamTruong} >1 &&#{HATamTruong}<80)  && d2:yearsBetween(A{Attr_DateBirthTHA},V{event_date}) < 65 ","programRuleActions":[{"programRuleActionType":"ASSIGN","dataElement":{"name":"Đạt MTĐT chuẩn mới"}}]},{"name":"THA_Đạt mục tiêu điều trị chuẩn mới_Show text","condition":"(#{HATamThu} >1 &&#{HATamThu}<140) &&(#{HATamTruong} >1 &&#{HATamTruong}<80)  && d2:yearsBetween(A{Attr_DateBirthTHA},V{event_date}) > 65    || (#{HATamThu} >1 &&#{HATamThu}<130) &&(#{HATamTruong} >1 &&#{HATamTruong}<80)  && d2:yearsBetween(A{Attr_DateBirthTHA},V{event_date}) < 65 ","programRuleActions":[{"programRuleActionType":"DISPLAYTEXT","content":"Đạt mục tiêu điều trị theo chuẩn mới"}]}]}